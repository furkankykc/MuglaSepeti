{% extends 'admin/change_list.html' %}
{% load static %}
{% block title %}
{% endblock %}
{% block extrastyle %}
    {{ block.super }}
    <style>

        table {
            display: table;
            width: 100%;
            /*height: 400px; !* for demo only *!*/
            /*border: 1px dotted blue;*/
        }

        td, th {
            padding: 10px;
            /*border: 1px dashed gray;*/
            display: table-cell;
            text-align: center;
            vertical-align: middle;
        }

        th.field-get_products {
            text-align: left;
        }

        a:link, a:visited {
            color: black;
        }


        .green {
            background: #CDEAC0;

        }

        .yellow {
            background: #EFE9AE;

        }

        .orange {
            background: #FEC3A6;
        }


        .red {
            background: #FF928B;

        }

        .brown {
            background: #FFAC81;
        }

        a.btn-chck {

            background: green;
        }

        input.btn-cancel, a.btn-cancel {
            background: red;
        }

        a.btn-prepare {
            background: orangered;
            justify-self: center;
            margin: auto;
        }

        a.btn-delivered {
            background: saddlebrown;
        }

        input.button, a.button {
            padding: 5px 0px;
            margin: 5px 0px;
            text-transform: uppercase;
            font-weight: bold;
            display: block;
            color: white;
            align-content: center;
            /*max-width: 150px;*/

        }

        input.hidden, a.hidden {
            display: none !important;
        }

    </style>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>

    <script>
        function toggleme(obj) {
            $(obj).children().toggleClass("hidden");
            {#element.toggleClass("hidden");#}
            {#console.log(obj);#}
        }

        var audio = new Audio('{% static 'sound/audio_file.wav' %}');
        audio.loop = true;
        var append_increment = 0;
        // Every 30 sec to control for new data
        setInterval(function () {
            $.ajax({
                type: "GET",
                url: '{% url 'admin:muglaSepetiApp_bucket_changelist' %}', // URL to your view that serves new info
                data: {'append_increment': append_increment}
            })
                .done(function (response) {
                    var success = $($.parseHTML(response)).find('#result_list');
                    var paginator = $($.parseHTML(response)).find('.paginator');
                    var counter = $($.parseHTML(response)).find('.action-counter');
                    $('#result_list').replaceWith(success);
                    $('.paginator').replaceWith(paginator);
                    $('.counter').replaceWith(counter);
                    append_increment += 10;
                    console.log("data:", success.toString())
                    //Check for checkbutton
                    var is_check_appeared = document.getElementsByName("chck").length > 0;
                    // if a check button appeared ring the bell bell
                    if (is_check_appeared) {

                        try {
                            audio.play();
                            console.log("playing sound");
                        } catch (e) {
                            print(e);
                            audio.play();
                        }
                    }
                });
        }, 30000)
    </script>
{% endblock %}